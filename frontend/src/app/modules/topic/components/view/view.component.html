<div class="list-page">
    <div class="loading" *ngIf="loading">
        <fa-icon [icon]="['fas', 'spinner']" [pulse]="true"></fa-icon>
        <p>Loading ...</p>
    </div>
    <div class="list" *ngIf="!loading">
        <div class="list-header">
            <h1><a routerLink="/category/{{category.id}}">{{category.title}}</a></h1>
            <h2>{{topic.title}}</h2>
            <a *ngIf="can_post" routerLink="/topic/create">Create new Post</a>
            <!-- <a *ngIf="can_edit" routerLink="/topic/edit/{{topic.id}}">Edit</a> -->
        </div>
        <!-- <div class="list-body"> -->
        <div class="topic">
            <div *ngIf="can_edit" class="edit-buttons">
                <!-- <button *ngIf="topic.can_edit">Edit</button> -->
                <button type="button">Edit</button>
                <button type="button">Delete</button>
            </div>
            <div class="user-card">
                {{topic.user.nick}}
                {{topic.user.rol}}
                <!-- {{topic.user.location}}
                    {{topic.user.birthday}} -->
            </div>
            <div class="topic-body">
                <p>{{topic.content}}</p>
                <p>{{topic.created_at | date}}</p>
            </div>
        </div>
        <div class="posts">
            <div class="row post" *ngFor="let post of posts">
                <div *ngIf="post.can_edit" class="edit-buttons">
                    <button type="button">Edit</button>
                    <button type="button">Delete</button>
                </div>
                <div class="user-card">
                    {{post.user.nick}}
                    {{post.user.rol}}
                    <!-- {{post.user.location}}
                    {{post.user.birthday | date}} -->
                </div>
                <div class="post-body">
                    <p> {{post.content}}</p>
                </div>
            </div>
        </div>
        <div class="form">
            <form [formGroup]="formPost" (ngSubmit)="submitPost()">
                <div>
                <textarea formControlName="content" required cols="30" rows="10"></textarea>
                <div class="message-block" *ngIf="!content?.valid && content?.touched">
                    <ng-container *ngFor="let validation of validationMessagesPost.content | keyvalue">
                        <div *ngIf="content?.errors?.[validation.key]">
                            <fa-icon [icon]="['fas', 'triangle-exclamation']"></fa-icon> {{ validation.value }}
                        </div>
                    </ng-container>
                </div>
                </div>
                <button [disabled]="!formPost.valid" type="submit">
                    Post
                </button>
            </form>
        </div>
        <!-- <ul>
                <li *ngFor="let post of posts">
                    <div class="title">
                        <div>
                            <h3>{{post.user_id}}</h3>
                        </div>
                        <div class="row">
                            <div class="buttons">
                                 <button *ngIf="post.can_edit">Edit</button>
                                <button type="button">Edit</button>
                                <button type="button">Delete</button>
                            </div>
                            <p>{{post.created_at | date}}</p>
                        </div>
                    </div>
                    <p>{{post.content}}</p>
                </li>
            </ul> -->
        <!-- </div> -->
        <div class="list-footer">
            <button type="button" (click)="scrollToTop()">Back to top</button>
            <div class="pagination">
                <a routerLink="/topic/{{topic.id}}" [queryParams]="{page: i+1}" [class]="{'active': current_page == i+1}" *ngFor="let item of [].constructor(last_page); let i = index">{{i+1}}</a>
            </div>
        </div>
    </div>
</div>